(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{62:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return l})),t.d(n,"metadata",(function(){return o})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return u}));var r=t(2),a=t(6),i=(t(0),t(80)),l={id:"recursion",title:"Recursion",sidebar_label:"Recursion"},o={unversionedId:"fp/recursion",id:"fp/recursion",isDocsHomePage:!1,title:"Recursion",description:"Recursion Causes Stack Overflow",source:"@site/docs/fp/recursion.md",slug:"/fp/recursion",permalink:"/docs/fp/recursion",version:"current",sidebar_label:"Recursion",sidebar:"j8PlusSidebar",previous:{title:"Functional Programming (FP)",permalink:"/docs/fp/"},next:{title:"Currying",permalink:"/docs/fp/currying"}},c=[{value:"Recursion Causes Stack Overflow",id:"recursion-causes-stack-overflow",children:[]},{value:"No Stack Overflow with Trampoline",id:"no-stack-overflow-with-trampoline",children:[]}],p={rightToc:c};function u(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"recursion-causes-stack-overflow"},"Recursion Causes Stack Overflow"),Object(i.b)("p",null,"JVMs of Java 8 and higher still don't support ",Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"http://en.wikipedia.org/wiki/Tail_call"}),"tail call optimization"),". So if you write a recursive method like the following one, you still get ",Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"http://docs.oracle.com/javase/8/docs/api/java/lang/StackOverflowError.html"}),"StackOverflowError"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"public class App {\n  public static Long termial(final Long n, final Long acc) {\n    if (n >= 1) {\n      return termial(n - 1, acc + n);\n    } else {\n      return acc;\n    }\n  }\n\n  public static void main(final String[] args) {\n    System.out.println(termial(100000L, 0L));\n  }\n}\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{}),'Exception in thread "main" java.lang.StackOverflowError\n    at App.termial(App.java:4)\n    at App.termial(App.java:4)\n    at App.termial(App.java:4)\n    at App.termial(App.java:4)\n    at App.termial(App.java:4)\n    at App.termial(App.java:4)\n    at App.termial(App.java:4)\n...\n')),Object(i.b)("h2",{id:"no-stack-overflow-with-trampoline"},"No Stack Overflow with Trampoline"),Object(i.b)("p",null,"It can be solved using ",Object(i.b)("inlineCode",{parentName:"p"},"TailCalls.trampoline()")," with small changes in the original method."),Object(i.b)("p",null,"Changes required:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"In the original method, put the return type in the type parameter of ",Object(i.b)("inlineCode",{parentName:"p"},"TailCallable"),"."),Object(i.b)("p",{parentName:"li"},"e.g.) ",Object(i.b)("inlineCode",{parentName:"p"},"Long")," => ",Object(i.b)("inlineCode",{parentName:"p"},"TailCallable<Long>"),".")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"When it's the end case, return the value with ",Object(i.b)("inlineCode",{parentName:"p"},"TailCalls.done()")," method."),Object(i.b)("p",{parentName:"li"},"e.g.) ",Object(i.b)("inlineCode",{parentName:"p"},"return acc;")," => ",Object(i.b)("inlineCode",{parentName:"p"},"return TailCalls.done(acc);"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Use a lambda expression for supplier for the recursive method call."),Object(i.b)("p",{parentName:"li"},"e.g.) ",Object(i.b)("inlineCode",{parentName:"p"},"return termial(n - 1, acc + n);")," => ",Object(i.b)("inlineCode",{parentName:"p"},"return () -> termial(n - 1, acc + n);")))),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"import j8plus.recursion.TailCallable;\nimport static j8plus.recursion.TailCalls.*;\n\npublic class App {\n  public static TailCallable<Long> termial(final Long n, final Long acc) {\n    if (n >= 1) {\n      return () -> termial(n - 1, acc + n);\n    } else {\n      return done(acc);\n    }\n  }\n\n  public static void main(final String[] args) {\n    System.out.println(trampoline(termial(100000L, 0L)));\n    // 5000050000L\n  }\n}\n")))}u.isMDXComponent=!0},80:function(e,n,t){"use strict";t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return f}));var r=t(0),a=t.n(r);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=a.a.createContext({}),u=function(e){var n=a.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=u(e.components);return a.a.createElement(p.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},m=a.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),s=u(t),m=r,f=s["".concat(l,".").concat(m)]||s[m]||b[m]||i;return t?a.a.createElement(f,o(o({ref:n},p),{},{components:t})):a.a.createElement(f,o({ref:n},p))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,l=new Array(i);l[0]=m;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=t[p];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"}}]);